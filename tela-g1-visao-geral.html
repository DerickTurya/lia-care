<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GestÃ£o de LicenÃ§as - Lia Care</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/lia-sync.js"></script>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">LIA</div>
                <div class="logo-text">
                    <h1>Lia Care</h1>
                    <p>LicenÃ§as e Afastamentos</p>
                </div>
            </div>
            <div class="user-info">
                <span>ðŸ‘”</span>
                <span>Maria Santos - Gestora</span>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">GestÃ£o de LicenÃ§as da Equipe</h2>
                <p class="card-subtitle">Acompanhe o status das licenÃ§as mÃ©dicas da sua equipe</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Colaboradores afastados</div>
                    <div class="stat-value" id="statActive">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">LicenÃ§as cadastradas</div>
                    <div class="stat-value" id="statTotal">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Novas (nÃ£o visualizadas)</div>
                    <div class="stat-value" style="color: var(--warning-color);" id="statPending">0</div>
                </div>
            </div>

            <div class="divider"></div>

            <!-- NotificaÃ§Ãµes em tempo real -->
            <div id="notificationBanner" style="display: none; background: linear-gradient(135deg, #4299E1 0%, #6B46C1 100%); color: white; padding: 16px 20px; border-radius: 12px; margin-bottom: 24px; animation: slideDown 0.4s ease-out;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 24px;">ðŸ””</span>
                    <div style="flex: 1;">
                        <div style="font-weight: 700; margin-bottom: 4px;" id="notifTitle">Nova licenÃ§a cadastrada!</div>
                        <div style="font-size: 14px; opacity: 0.95;" id="notifMessage">Um colaborador acabou de cadastrar uma licenÃ§a</div>
                    </div>
                    <button onclick="dismissNotification()" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        Ver
                    </button>
                </div>
            </div>

            <style>
                @keyframes slideDown {
                    from {
                        opacity: 0;
                        transform: translateY(-20px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                @keyframes pulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                }
                .pulse {
                    animation: pulse 2s infinite;
                }
            </style>

            <div class="ai-message">
                <div class="ai-message-header">
                    <span>ðŸ¤–</span>
                    <span>LIA - Assistente Inteligente</span>
                </div>
                <div class="ai-message-content">
                    <p style="margin-bottom: 16px; font-size: 16px;"><strong>OlÃ¡, Maria! ðŸ‘‹ Bem-vinda ao seu painel.</strong></p>
                    <p style="margin-bottom: 12px;">Estou monitorando as licenÃ§as da sua equipe em tempo real.</p>
                    <p style="margin-bottom: 12px; font-size: 15px; font-weight: 600;">O que eu faÃ§o por vocÃª:</p>
                    <ul style="margin: 12px 0; padding-left: 20px; line-height: 2;">
                        <li>ðŸ“Š <strong>Consolido</strong> todas as informaÃ§Ãµes em um sÃ³ lugar</li>
                        <li>ðŸ”” <strong>Te notifico</strong> sobre novos afastamentos</li>
                        <li>âš ï¸ <strong>Destaco</strong> pendÃªncias que precisam de atenÃ§Ã£o</li>
                        <li>ðŸ“ˆ <strong>Acompanho</strong> prazos e processos do INSS</li>
                        <li>âœ… <strong>Mantenho tudo</strong> organizado automaticamente</li>
                    </ul>
                    <p style="margin-top: 16px; font-size: 15px;">Relaxe e foque na gestÃ£o estratÃ©gica. Eu cuido da parte operacional! ðŸ’™</p>
                </div>
            </div>

            <h3 style="font-size: 16px; font-weight: 600; margin: 24px 0 16px;">LicenÃ§as recentes</h3>

            <div id="licensesList">
                <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                    <div style="font-size: 48px; margin-bottom: 16px;">ðŸ“‹</div>
                    <p>Nenhuma licenÃ§a cadastrada ainda</p>
                    <p style="font-size: 14px; margin-top: 8px;">Quando um colaborador cadastrar uma licenÃ§a, ela aparecerÃ¡ aqui automaticamente!</p>
                </div>
            </div>

            <div class="divider"></div>

            <h3 style="font-size: 16px; font-weight: 600; margin: 24px 0 16px;">AÃ§Ãµes pendentes</h3>

            <div class="list-item" style="border-left: 4px solid var(--warning-color);">
                <div class="list-item-content">
                    <h3>Revisar documentaÃ§Ã£o</h3>
                    <p>Pedro Santos aguarda validaÃ§Ã£o de documentos complementares</p>
                </div>
                <div class="list-item-action" style="color: var(--warning-color);">Revisar â†’</div>
            </div>

            <div class="list-item" style="border-left: 4px solid var(--warning-color);">
                <div class="list-item-content">
                    <h3>AtualizaÃ§Ã£o necessÃ¡ria</h3>
                    <p>Juliana Lima - Retorno previsto foi alterado</p>
                </div>
                <div class="list-item-action" style="color: var(--warning-color);">Revisar â†’</div>
            </div>

            <div class="alert alert-info mt-3">
                <strong>ðŸ“Š RelatÃ³rios:</strong> Acesse relatÃ³rios detalhados de absenteÃ­smo e tendÃªncias da equipe atravÃ©s do menu principal.
            </div>

            <div style="margin-top: 32px;">
                <a href="tela-05a-confirmacao.html" class="btn btn-primary btn-block">
                    ðŸ§ª Simular cadastro de licenÃ§a (Teste)
                </a>
                
                <button onclick="clearAllData()" class="btn btn-secondary btn-block">
                    ðŸ—‘ï¸ Limpar todos os dados (Reset)
                </button>
            </div>
        </div>
    </div>

    <script>
        let notificationTimeout;

        // Limpa todos os dados
        function clearAllData() {
            if (confirm('Tem certeza? Isso apagarÃ¡ todas as licenÃ§as e notificaÃ§Ãµes cadastradas.')) {
                window.liaSync.clearAll();
                updateStats();
                renderLicenses();
                alert('âœ… Todos os dados foram limpos!');
            }
        }

        // Atualiza estatÃ­sticas
        function updateStats() {
            const stats = window.liaSync.getStats();
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statActive').textContent = stats.active;
            document.getElementById('statPending').textContent = stats.pending;

            // Adiciona efeito de pulso se houver pendÃªncias
            const pendingElement = document.getElementById('statPending');
            if (stats.pending > 0) {
                pendingElement.classList.add('pulse');
            } else {
                pendingElement.classList.remove('pulse');
            }
        }

        // Renderiza lista de licenÃ§as
        function renderLicenses() {
            const licenses = window.liaSync.getLicenses();
            const container = document.getElementById('licensesList');

            if (licenses.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                        <div style="font-size: 48px; margin-bottom: 16px;">ðŸ“‹</div>
                        <p>Nenhuma licenÃ§a cadastrada ainda</p>
                        <p style="font-size: 14px; margin-top: 8px;">Quando um colaborador cadastrar uma licenÃ§a, ela aparecerÃ¡ aqui automaticamente!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = licenses.map(license => {
                const isNew = !license.managerViewed;
                const badgeClass = license.status.includes('Aguardando') ? 'status-pending' : 'status-info';
                
                return `
                    <div class="list-item" onclick="viewLicense(${license.id})" style="cursor: pointer; ${isNew ? 'border-left: 4px solid var(--aiia-blue); background: linear-gradient(135deg, rgba(66, 153, 225, 0.05) 0%, rgba(107, 70, 193, 0.05) 100%);' : ''}">
                        <div class="list-item-content">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <h3>${license.employeeName}</h3>
                                ${isNew ? '<span style="background: var(--aiia-gradient); color: white; font-size: 11px; padding: 4px 10px; border-radius: 12px; font-weight: 600;">NOVA</span>' : ''}
                            </div>
                            <p>${license.position} â€¢ ${license.days} dias â€¢ Cadastrada em ${license.createdAt}</p>
                            <div style="margin-top: 8px;">
                                <span class="status-badge ${badgeClass}">${license.status}</span>
                            </div>
                        </div>
                        <div class="list-item-action">Ver detalhes â†’</div>
                    </div>
                `;
            }).join('');
        }

        // Visualiza licenÃ§a
        function viewLicense(licenseId) {
            window.liaSync.markAsViewed(licenseId);
            updateStats();
            renderLicenses();
            // Em produÃ§Ã£o, redirecionaria para pÃ¡gina de detalhes
            alert('Em produÃ§Ã£o, abriria a pÃ¡gina de detalhes da licenÃ§a.');
        }

        // Mostra notificaÃ§Ã£o
        function showNotification(notification) {
            const banner = document.getElementById('notificationBanner');
            document.getElementById('notifTitle').textContent = notification.title;
            document.getElementById('notifMessage').textContent = notification.message;
            
            banner.style.display = 'block';
            
            // Auto-esconder apÃ³s 10 segundos
            clearTimeout(notificationTimeout);
            notificationTimeout = setTimeout(() => {
                dismissNotification();
            }, 10000);

            // Som de notificaÃ§Ã£o (opcional)
            try {
                new Audio('data:audio/wav;base64,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').play();
            } catch(e) {}
        }

        // Esconde notificaÃ§Ã£o
        function dismissNotification() {
            document.getElementById('notificationBanner').style.display = 'none';
        }

        // Listener para novas licenÃ§as
        window.addEventListener('lia:newNotification', (e) => {
            console.log('ðŸ”” Nova notificaÃ§Ã£o recebida:', e.detail);
            showNotification(e.detail);
            updateStats();
            renderLicenses();
        });

        // Listener para atualizaÃ§Ãµes (outras abas/janelas)
        window.addEventListener('lia:dataUpdated', () => {
            console.log('ðŸ”„ Dados atualizados de outra fonte');
            updateStats();
            renderLicenses();
        });

        // Carrega dados ao iniciar
        window.addEventListener('DOMContentLoaded', () => {
            updateStats();
            renderLicenses();

            // Verifica novas notificaÃ§Ãµes
            const unread = window.liaSync.getUnreadNotifications();
            if (unread.length > 0) {
                showNotification(unread[0]);
            }
        });

        // Auto-refresh a cada 5 segundos (simula polling em produÃ§Ã£o seria WebSocket)
        setInterval(() => {
            const currentStats = window.liaSync.getStats();
            const displayedTotal = parseInt(document.getElementById('statTotal').textContent);
            
            // Se houver mudanÃ§a, atualiza
            if (currentStats.total !== displayedTotal) {
                updateStats();
                renderLicenses();
            }
        }, 5000);
    </script>
</body>
</html>


